# Iceberg REST Catalog Configuration
# Copy this file to config.yaml and modify as needed
# Environment variables override these settings with ICEBERG_ prefix
# Example: ICEBERG_SERVER_PORT=8080

server:
  host: 0.0.0.0
  port: 8181
  debug: false
  version: "0.1.0"
  read_timeout: 30s
  write_timeout: 30s
  idle_timeout: 120s

database:
  host: localhost
  port: 5432
  user: iceberg
  password: iceberg
  database: iceberg_catalog
  ssl_mode: disable
  max_open_conns: 25
  max_idle_conns: 5
  conn_max_lifetime: 5m
  conn_max_idle_time: 5m

storage:
  # Options: s3, gcs, local
  type: local
  warehouse: /tmp/iceberg/warehouse

  # S3/MinIO configuration
  s3:
    endpoint: ""  # Leave empty for AWS S3, set for MinIO
    region: us-east-1
    access_key_id: ""
    secret_access_key: ""
    bucket: warehouse
    use_path_style: false  # Set to true for MinIO

  # Google Cloud Storage configuration
  gcs:
    project: ""
    credentials_file: ""
    bucket: ""

  # Local filesystem configuration
  local:
    root_path: /tmp/iceberg/data

auth:
  enabled: false
  token_expiry: 1h
  signing_key: "change-me-in-production"

  oauth2:
    enabled: false
    issuer: ""
    client_id: ""
    client_secret: ""

  api_key:
    enabled: false

catalog:
  prefix: ""
  default_warehouse: ""
  lock_timeout: 30s
  lock_retry_interval: 100ms
  max_lock_retries: 100

# Compatibility layers (all disabled by default)
compat:
  # Enable Apache Polaris API compatibility
  # When enabled, adds:
  #   - Path rewriting: /api/catalog/v1/{catalog}/... -> /v1/...
  #   - Polaris OAuth endpoint: /api/catalog/v1/oauth/tokens
  #   - Mock Management API: /api/management/v1/catalogs
  # Useful for running polaris-tools benchmarks
  polaris_enabled: false
